[0m10:04:00.166694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e2e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078afd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ad090>]}


============================== 10:04:00.168842 | 0c38bdc2-fb5c-4694-b774-06ec510a9bad ==============================
[0m10:04:00.168842 [info ] [MainThread]: Running with dbt=1.10.11
[0m10:04:00.169107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'log_cache_events': 'False', 'profiles_dir': '/Users/harshsareen/Documents/mazenet_solution/data_engineer/usecases/use_case_one', 'warn_error': 'None', 'quiet': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'write_json': 'True', 'empty': 'False', 'use_colors': 'True', 'target_path': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/harshsareen/Documents/mazenet_solution/data_engineer/usecases/use_case_one/logs', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'no_print': 'None', 'static_parser': 'True', 'introspect': 'True'}
[0m10:04:00.201218 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m10:04:00.201487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0c38bdc2-fb5c-4694-b774-06ec510a9bad', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba88a0>]}
[0m10:04:00.248695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c38bdc2-fb5c-4694-b774-06ec510a9bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107753460>]}
[0m10:04:00.273095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c38bdc2-fb5c-4694-b774-06ec510a9bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10777b850>]}
[0m10:04:00.274312 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m10:04:00.365139 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m10:04:00.365533 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:04:00.365693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0c38bdc2-fb5c-4694-b774-06ec510a9bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108388140>]}
[0m10:04:00.770847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c38bdc2-fb5c-4694-b774-06ec510a9bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079835b0>]}
[0m10:04:00.793002 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harshsareen/Documents/mazenet_solution/data_engineer/usecases/use_case_one/target/manifest.json
[0m10:04:00.794058 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harshsareen/Documents/mazenet_solution/data_engineer/usecases/use_case_one/target/semantic_manifest.json
[0m10:04:00.806056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c38bdc2-fb5c-4694-b774-06ec510a9bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107985160>]}
[0m10:04:00.806321 [info ] [MainThread]: Found 1 model, 434 macros
[0m10:04:00.806470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c38bdc2-fb5c-4694-b774-06ec510a9bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c8410>]}
[0m10:04:00.807429 [info ] [MainThread]: 
[0m10:04:00.807622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:04:00.807743 [info ] [MainThread]: 
[0m10:04:00.807951 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:04:00.808481 [debug] [ThreadPool]: Acquiring new postgres connection 'list_de_db'
[0m10:04:00.841048 [debug] [ThreadPool]: Using postgres connection "list_de_db"
[0m10:04:00.841256 [debug] [ThreadPool]: On list_de_db: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "default", "target_name": "dev", "connection_name": "list_de_db"} */

    select distinct nspname from pg_namespace
  
[0m10:04:00.841374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:00.859497 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.018 seconds
[0m10:04:00.860103 [debug] [ThreadPool]: On list_de_db: Close
[0m10:04:00.860390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_de_db, now create_de_db_analytics)
[0m10:04:00.860552 [debug] [ThreadPool]: Creating schema "database: "de_db"
schema: "analytics"
"
[0m10:04:00.862635 [debug] [ThreadPool]: Using postgres connection "create_de_db_analytics"
[0m10:04:00.862761 [debug] [ThreadPool]: On create_de_db_analytics: BEGIN
[0m10:04:00.862869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:04:00.869837 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m10:04:00.869979 [debug] [ThreadPool]: Using postgres connection "create_de_db_analytics"
[0m10:04:00.870091 [debug] [ThreadPool]: On create_de_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "default", "target_name": "dev", "connection_name": "create_de_db_analytics"} */
create schema if not exists "analytics"
[0m10:04:00.870931 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m10:04:00.871286 [debug] [ThreadPool]: On create_de_db_analytics: COMMIT
[0m10:04:00.871390 [debug] [ThreadPool]: Using postgres connection "create_de_db_analytics"
[0m10:04:00.871479 [debug] [ThreadPool]: On create_de_db_analytics: COMMIT
[0m10:04:00.872256 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m10:04:00.872377 [debug] [ThreadPool]: On create_de_db_analytics: Close
[0m10:04:00.873417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_de_db_analytics, now list_de_db_analytics)
[0m10:04:00.875562 [debug] [ThreadPool]: Using postgres connection "list_de_db_analytics"
[0m10:04:00.875692 [debug] [ThreadPool]: On list_de_db_analytics: BEGIN
[0m10:04:00.875786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:04:00.881896 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:04:00.882058 [debug] [ThreadPool]: Using postgres connection "list_de_db_analytics"
[0m10:04:00.882179 [debug] [ThreadPool]: On list_de_db_analytics: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "default", "target_name": "dev", "connection_name": "list_de_db_analytics"} */
select
      'de_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'de_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'de_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m10:04:00.885716 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m10:04:00.886146 [debug] [ThreadPool]: On list_de_db_analytics: ROLLBACK
[0m10:04:00.886846 [debug] [ThreadPool]: On list_de_db_analytics: Close
[0m10:04:00.889027 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:00.889177 [debug] [MainThread]: On master: BEGIN
[0m10:04:00.889297 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:04:00.896137 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:04:00.896315 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:00.896481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:04:00.900107 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:04:00.900644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c38bdc2-fb5c-4694-b774-06ec510a9bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e5020>]}
[0m10:04:00.900845 [debug] [MainThread]: On master: ROLLBACK
[0m10:04:00.901401 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:00.901527 [debug] [MainThread]: On master: BEGIN
[0m10:04:00.902542 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:04:00.902697 [debug] [MainThread]: On master: COMMIT
[0m10:04:00.902815 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:00.902917 [debug] [MainThread]: On master: COMMIT
[0m10:04:00.903488 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:04:00.903615 [debug] [MainThread]: On master: Close
[0m10:04:00.906263 [debug] [Thread-1 (]: Began running node model.mazenet_use_case_one.events_summary
[0m10:04:00.906593 [info ] [Thread-1 (]: 1 of 1 START sql table model analytics.events_summary .......................... [RUN]
[0m10:04:00.906833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_de_db_analytics, now model.mazenet_use_case_one.events_summary)
[0m10:04:00.906985 [debug] [Thread-1 (]: Began compiling node model.mazenet_use_case_one.events_summary
[0m10:04:00.909850 [debug] [Thread-1 (]: Writing injected SQL for node "model.mazenet_use_case_one.events_summary"
[0m10:04:00.910453 [debug] [Thread-1 (]: Began executing node model.mazenet_use_case_one.events_summary
[0m10:04:00.931542 [debug] [Thread-1 (]: Writing runtime sql for node "model.mazenet_use_case_one.events_summary"
[0m10:04:00.932490 [debug] [Thread-1 (]: Using postgres connection "model.mazenet_use_case_one.events_summary"
[0m10:04:00.932888 [debug] [Thread-1 (]: On model.mazenet_use_case_one.events_summary: BEGIN
[0m10:04:00.933067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:00.940960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m10:04:00.941165 [debug] [Thread-1 (]: Using postgres connection "model.mazenet_use_case_one.events_summary"
[0m10:04:00.941302 [debug] [Thread-1 (]: On model.mazenet_use_case_one.events_summary: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "default", "target_name": "dev", "node_id": "model.mazenet_use_case_one.events_summary"} */

  
    

  create  table "de_db"."analytics"."events_summary__dbt_tmp"
  
  
    as
  
  (
    SELECT
    date(processed_at) AS day,
    COUNT(*) FILTER (WHERE action='view') AS views,
    COUNT(*) FILTER (WHERE action='cart') AS carts,
    COUNT(*) FILTER (WHERE action='purchase') AS purchases
FROM events
GROUP BY 1
ORDER BY 1;
  );
  
[0m10:04:00.941935 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 19: ORDER BY 1;
                   ^

[0m10:04:00.942060 [debug] [Thread-1 (]: On model.mazenet_use_case_one.events_summary: ROLLBACK
[0m10:04:00.942593 [debug] [Thread-1 (]: On model.mazenet_use_case_one.events_summary: Close
[0m10:04:00.947670 [debug] [Thread-1 (]: Database Error in model events_summary (models/events_summary.sql)
  syntax error at or near ";"
  LINE 19: ORDER BY 1;
                     ^
  compiled code at target/run/mazenet_use_case_one/models/events_summary.sql
[0m10:04:00.948586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c38bdc2-fb5c-4694-b774-06ec510a9bad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067976b0>]}
[0m10:04:00.948863 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model analytics.events_summary ................. [[31mERROR[0m in 0.04s]
[0m10:04:00.949102 [debug] [Thread-1 (]: Finished running node model.mazenet_use_case_one.events_summary
[0m10:04:00.949329 [debug] [Thread-4 (]: Marking all children of 'model.mazenet_use_case_one.events_summary' to be skipped because of status 'error'.  Reason: Database Error in model events_summary (models/events_summary.sql)
  syntax error at or near ";"
  LINE 19: ORDER BY 1;
                     ^
  compiled code at target/run/mazenet_use_case_one/models/events_summary.sql.
[0m10:04:00.950139 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:00.950291 [debug] [MainThread]: On master: BEGIN
[0m10:04:00.950393 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:04:00.957488 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:04:00.957681 [debug] [MainThread]: On master: COMMIT
[0m10:04:00.957803 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:00.957906 [debug] [MainThread]: On master: COMMIT
[0m10:04:00.958348 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:04:00.958470 [debug] [MainThread]: On master: Close
[0m10:04:00.958643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:00.958751 [debug] [MainThread]: Connection 'model.mazenet_use_case_one.events_summary' was properly closed.
[0m10:04:00.958858 [info ] [MainThread]: 
[0m10:04:00.958979 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m10:04:00.959263 [debug] [MainThread]: Command end result
[0m10:04:00.967385 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harshsareen/Documents/mazenet_solution/data_engineer/usecases/use_case_one/target/manifest.json
[0m10:04:00.968190 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harshsareen/Documents/mazenet_solution/data_engineer/usecases/use_case_one/target/semantic_manifest.json
[0m10:04:00.970653 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/harshsareen/Documents/mazenet_solution/data_engineer/usecases/use_case_one/target/run_results.json
[0m10:04:00.970782 [info ] [MainThread]: 
[0m10:04:00.970929 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:04:00.971047 [info ] [MainThread]: 
[0m10:04:00.971210 [error] [MainThread]: [31mFailure in model events_summary (models/events_summary.sql)[0m
[0m10:04:00.971378 [error] [MainThread]:   Database Error in model events_summary (models/events_summary.sql)
  syntax error at or near ";"
  LINE 19: ORDER BY 1;
                     ^
  compiled code at target/run/mazenet_use_case_one/models/events_summary.sql
[0m10:04:00.971488 [info ] [MainThread]: 
[0m10:04:00.971623 [info ] [MainThread]:   compiled code at target/compiled/mazenet_use_case_one/models/events_summary.sql
[0m10:04:00.971725 [info ] [MainThread]: 
[0m10:04:00.971850 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:04:00.972055 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigSourcePathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:04:00.973777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8374567, "process_in_blocks": "0", "process_kernel_time": 0.226065, "process_mem_max_rss": "151175168", "process_out_blocks": "0", "process_user_time": 1.599882}
[0m10:04:00.973962 [debug] [MainThread]: Command `dbt run` failed at 10:04:00.973926 after 0.84 seconds
[0m10:04:00.974118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f91d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c69dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107948520>]}
[0m10:04:00.974248 [debug] [MainThread]: Flushing usage events
[0m10:04:02.322535 [debug] [MainThread]: An error was encountered while trying to flush usage events
